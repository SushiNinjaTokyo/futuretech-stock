<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>{{ name }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="{{ css_href }}">
</head>
<body>
  <div class="wrap">
    <header class="header">
      <h1>{{ name }}</h1>
      <p class="muted small">Generated at {{ generated_at }} • Weights: 
        pv={{ "%.2f"|format(weights.get("price_vol_anom", 0)) }},
        dii={{ "%.2f"|format(weights.get("dii", 0)) }},
        trends={{ "%.2f"|format(weights.get("trends", 0)) }},
        news={{ "%.2f"|format(weights.get("news", 0)) }}
      </p>
    </header>

    {% if items and items|length > 0 %}
    <section class="card">
      <h2 class="card__title">Top 10 — {{ date }}</h2>
      <div class="table">
        <div class="table__head">
          <div>#</div>
          <div>Symbol</div>
          <div>Total</div>
          <div>Price Vol</div>
          <div>DII</div>
          <div>Trends</div>
          <div>News</div>
        </div>
        <div class="table__body">
          {% for it in items %}
          {% set comp = it.get("components", {}) %}
          <div class="row">
            <div>{{ loop.index }}</div>
            <div class="sym">{{ it.symbol or it.get("symbol") }}</div>
            <div>{{ "%.3f"|format(it.score_0_1 or it.get("score_0_1", 0)) }}</div>
            <div>{{ "%.3f"|format(comp.get("price_vol_anom", 0)) }}</div>
            <div>{{ "%.3f"|format(comp.get("dii", 0)) }}</div>
            <div>{{ "%.3f"|format(comp.get("trends", 0)) }}</div>
            <div>{{ "%.3f"|format(comp.get("news", 0)) }}</div>
          </div>
          {% endfor %}
        </div>
      </div>
    </section>
    {% else %}
    <p class="muted">No items to display.</p>
    {% endif %}

    <footer class="footer small muted">
      <p>© {{ date[:4] }} FutureTech — Auto-generated daily report.</p>
    </footer>
  </div>
</body>
</html>
